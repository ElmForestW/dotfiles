# Download plugins
PLUGINS_DIR=${XDG_DATA_HOME:-$HOME/.local/share}/zsh/plugins
if [[ ! -e $PLUGINS_DIR ]]; then
  mkdir -p "$PLUGINS_DIR"
fi
if [[ ! -e $PLUGINS_DIR/fast-syntax-highlighting ]]; then
  git clone --depth=1 https://github.com/zdharma-continuum/fast-syntax-highlighting.git "$PLUGINS_DIR"/fast-syntax-highlighting
fi
if [[ ! -e $PLUGINS_DIR/zsh-autosuggestions ]]; then
  git clone --depth=1 https://github.com/zsh-users/zsh-autosuggestions.git "$PLUGINS_DIR"/zsh-autosuggestions
fi
if [[ ! -e $PLUGINS_DIR/powerlevel10k ]]; then
  git clone --depth=1 https://github.com/romkatv/powerlevel10k.git "$PLUGINS_DIR"/powerlevel10k
fi

# Activate Powerlevel10k Instant Prompt
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

# Zsh options
autoload -Uz compinit && compinit -d "${XDG_CACHE_HOME:-$HOME/.cache}"
bindkey -e

bindkey "^[[1;5D" backward-word
bindkey "^[[1;5C" forward-word
bindkey "^[[3~" delete-char
setopt correctall
setopt sharehistory

# PS1="%F{cyan}%~%f > "
HISTFILE=${XDG_STATE_HOME:-$HOME/.local/state}/zsh_history
HISTSIZE=10000000
SAVEHIST=10000000
POWERLEVEL9K_CONFIG_FILE="$HOME/.config/zsh/p10k.zsh"
ZSH_AUTOSUGGEST_MANUAL_REBIND=1

alias ls="ls --color"
alias ll="ls -lh"
alias la="ls -lAh"
alias v="nvim"
alias vim="nvim"
alias gi="lazygit"

alias pb='curl -F "c=@-" "https://pb.elmf.me/"'
alias setproxy="export {http,https}_proxy=http://127.0.0.1:1080"
alias unsetproxy="unset {http,https}_proxy"

export XDG_DATA_HOME=$HOME/.local/share
export XDG_CONFIG_HOME=$HOME/.config
export XDG_STATE_HOME=$HOME/.local/state
export XDG_CACHE_HOME=$HOME/.cache
export PATH=$XDG_DATA_HOME/cargo/bin:$PATH

export EDITOR=nvim
export TERMINAL=foot
export http_proxy=http://127.0.0.1:1080
export https_proxy=http://127.0.0.1:1080

export GNUPGHOME=$XDG_DATA_HOME/gnupg
export CARGO_HOME=$XDG_DATA_HOME/cargo
export RUSTUP_HOME=$XDG_DATA_HOME/rustup
export GOPATH=$XDG_DATA_HOME/go

export HISTFILE=$XDG_STATE_HOME/bash_history
export NODE_REPL_HISTORY=$XDG_DATA_HOME/node_repl_history
export PYTHON_HISTORY=$XDG_STATE_HOME/python_history

# Load plugins
source "$PLUGINS_DIR"/fast-syntax-highlighting/fast-syntax-highlighting.plugin.zsh
source "$PLUGINS_DIR"/zsh-autosuggestions/zsh-autosuggestions.zsh
source "$PLUGINS_DIR"/powerlevel10k/powerlevel10k.zsh-theme
source ~/.config/zsh/p10k.zsh

# Load external programs
eval "$(zoxide init zsh)"
eval "$(fzf --zsh)"
